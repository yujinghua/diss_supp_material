# Unit Test Specification of OpenSSL_CAPL_Sec.dll Functions - 2

## TG_dllSymmetryDecrypt

### 2.1 TC_dllSymmetryDecrypt_invalid_cipher_name
**Purpose:** To check the function behaviors when an invalid cipher name is input<br>
**Test setup:** key = “akey”; iv = “”; cipher text = "c1a9d48932d01b10913b29e6e43f3126”; cipher text length = 16; <br>
**Sub test cases 1: Input an invalid cipher name**
* input: cipher name = "bes-128-ecb”
* expected output: null (the function is abort)
* expected return: error code = 100 (cipher name is invalid)

**Sub test cases 2: Input a null cipher name**
* input: cipher name = null
* expected output: null (the function is abort)
* expected return: error code = 100 (cipher name is invalid)

### 2.2.1 TC_dllSymmetryDecrypt_aes_128_ecb_normal 
**Purpose:** To check whether the function works normally<br>
**Test setup:** cipher name = “aes-128-ecb”; key = “akey”; iv = “”; cipher text = "c1a9d48932d01b10913b29e6e43f3126”; cipher text length = 16;  <br>
**Sub test cases 1: Normal operation**
* input: /
* expected output: plain text = “Hello World!”; plain text length = 12;
* expected return: 1 (operation succeeds)

### 2.2.2 TC_dllSymmetryDecrypt_aes_128_ecb_aKey
**Purpose:** To check the function behaviors when various key values are input<br>
**Test setup:** cipher name = “aes-128-ecb”; iv = “”; cipher text = “ c1a9d48932d01b10913b29e6e43f3126”; cipher text length = 16;  <br>
**Sub test cases 1: Input key is correct**
* input: key = “akey”;
* expected output: plain text = "Hello World!”; plain text length = 12;
* expected return: 1 (operation succeeds)

**Sub test cases 2: Input key is wrong**
* input: key = “abcdef”;
* expected output: /
* expected return: != 1 (operation does not succeed)

**Sub test cases 4: Input key = null**
* input: key = “”;
* expected output: /
* expected return: != 1 (operation does not succeed)

### 2.2.3 TC_dllSymmetryDecrypt_aes_128_ecb_iv
**Purpose:** To check the function behaviors when various iv values are input<br>
**Test setup:** cipher name = “aes-128-ecb”; key = “akey”; cipher text = “ c1a9d48932d01b10913b29e6e43f3126”; cipher text length = 16;  <br>
**Sub test cases 1: Input iv = null**
* input: iv = “”;
* expected output: plain text = "Hello World!”; plain text length = 12;
* expected return: 1 (operation succeeds)

**Sub test cases 2: Input iv != null**
* input: iv = “iv”;
* expected output: plain text = "Hello World!”; plain text length = 12;
* expected return: 1 (operation succeeds)

### 2.2.4 TC_dllSymmetryDecrypt_aes_128_ecb_in_ciphertext
**Purpose:** To check the function behaviors when various ciphertext values are input<br>
**Test setup:** cipher name = “aes-128-ecb”; key = “akey”; iv = “”;   <br>
**Sub test cases 1: Input cipher text is correct**
* input: cipher text = “c1a9d48932d01b10913b29e6e43f3126”; cipher text length = 16;
* expected output: plain text = "Hello World!”; plain text length = 12;
* expected return: 1 (operation succeeds)

**Sub test cases 2: Input cipher text is not correct**
* input: cipher text = “ c1a9d48932d59730913b29e6e43f3122”; cipher text length = 16;
* expected output: /
* expected return: != 1 (operation does not succeed)

**Sub test cases 3: Input cipher text is large (correct cipher text)**
* input: cipher text = “ 90d07376652ce39366f1e7aa786f40bc3c2d918643bd79aa73f1d1581126a59b115023b798abea591e7f810b21e3c9ba9729c1564ae1598b5b3e52b64ee35afe4a490213f0234111093cf68cf5d292f490d07376652ce39366f1e7aa786f40bc3c2d918643bd79aa73f1d1581126a59b115023b798abea591e7f810b21e3c9ba9729c1564ae1598b5b3e52b64ee35afe4a490213f0234111093cf68cf5d292f490d07376652ce39366f1e7aa786f40bc3c2d918643bd79aa73f1d1581126a59b115023b798abea591e7f810b21e3c9ba9729c1564ae1598b5b3e52b64ee35afe4a490213f0234111093cf68cf5d292f490d07376652ce39366f1e7aa786f40bc3c2d918643bd79aa73f1d1581126a59b115023b798abea591e7f810b21e3c9ba9729c1564ae1598b5b3e52b64ee35afe4a490213f0234111093cf68cf5d292f490d07376652ce39366f1e7aa786f40bc3c2d918643bd79aa73f1d1581126a59b115023b798abea591e7f810b21e3c9ba9729c1564ae1598b5b3e52b64ee35afe4a490213f0234111093cf68cf5d292f490d07376652ce39366f1e7aa786f40bc3c2d918643bd79aa73f1d1581126a59b115023b798abea591e7f810b21e3c9ba9729c1564ae1598b5b3e52b64ee35afe4a490213f0234111093cf68cf5d292f490d07376652ce39366f1e7aa786f40bc3c2d918643bd79aa73f1d1581126a59b115023b798abea591e7f810b21e3c9ba9729c1564ae1598b5b3e52b64ee35afe4a490213f0234111093cf68cf5d292f490d07376652ce39366f1e7aa786f40bc3c2d918643bd79aa73f1d1581126a59b115023b798abea591e7f810b21e3c9ba9729c1564ae1598b5b3e52b64ee35afe4a490213f0234111093cf68cf5d292f490d07376652ce39366f1e7aa786f40bc3c2d918643bd79aa73f1d1581126a59b115023b798abea591e7f810b21e3c9ba9729c1564ae1598b5b3e52b64ee35afe4a490213f0234111093cf68cf5d292f490d07376652ce39366f1e7aa786f40bc3c2d918643bd79aa73f1d1581126a59b115023b798abea591e7f810b21e3c9ba9729c1564ae1598b5b3e52b64ee35afe4a490213f0234111093cf68cf5d292f490d07376652ce39366f1e7aa786f40bc3c2d918643bd79aa73f1d1581126a59b115023b798abea591e7f810b21e3c9ba9729c1564ae1598b5b3e52b64ee35afe4a490213f0234111093cf68cf5d292f490d07376652ce39366f1e7aa786f40bc3c2d918643bd79aa73f1d1581126a59b115023b798abea591e7f810b21e3c9ba9729c1564ae1598b5b3e52b64ee35afe4a490213f0234111093cf68cf5d292f490d07376652ce39366f1e7aa786f40bc3c2d918643bd79aa73f1d1581126a59b115023b798abea591e7f810b21e3c9ba9729c1564ae1598b5b3e52b64ee35afe4a490213f0234111093cf68cf5d292f490d07376652ce39366f1e7aa786f40bc3c2d918643bd79aa73f1d1581126a59b115023b798abea591e7f810b21e3c9ba9729c1564ae1598b5b3e52b64ee35afe4a490213f0234111093cf68cf5d292f490d07376652ce39366f1e7aa786f40bc3c2d918643bd79aa73f1d1581126a59b115023b798abea591e7f810b21e3c9ba9729c1564ae1598b5b3e52b64ee35afe4a490213f0234111093cf68cf5d292f490d07376652ce39366f1e7aa786f40bc3c2d918643bd79aa73f1d1581126a59b115023b798abea591e7f810b21e3c9ba9729c1564ae1598b5b3e52b64ee35afe4a490213f0234111093cf68cf5d292f490d07376652ce39366f1e7aa786f40bc3c2d918643bd79aa73f1d1581126a59b115023b798abea591e7f810b21e3c9ba9729c1564ae1598b5b3e52b64ee35afe4a490213f0234111093cf68cf5d292f490d07376652ce39366f1e7aa786f40bc3c2d918643bd79aa73f1d1581126a59b115023b798abea591e7f810b21e3c9ba9729c1564ae1598b5b3e52b64ee35afe4a490213f0234111093cf68cf5d292f490d07376652ce39366f1e7aa786f40bc3c2d918643bd79aa73f1d1581126a59b115023b798abea591e7f810b21e3c9ba9729c1564ae1598b5b3e52b64ee35afe4a490213f0234111093cf68cf5d292f490d07376652ce39366f1e7aa786f40bc3c2d918643bd79aa73f1d1581126a59b115023b798abea591e7f810b21e3c9ba9729c1564ae1598b5b3e52b64ee35afe4a490213f0234111093cf68cf5d292f490d07376652ce39366f1e7aa786f40bc3c2d918643bd79aa73f1d1581126a59b115023b798abea591e7f810b21e3c9ba9729c1564ae1598b5b3e52b64ee35afe4a490213f0234111093cf68cf5d292f490d07376652ce39366f1e7aa786f40bc3c2d918643bd79aa73f1d1581126a59b115023b798abea591e7f810b21e3c9ba9729c1564ae1598b5b3e52b64ee35afe4a490213f0234111093cf68cf5d292f490d07376652ce39366f1e7aa786f40bc3c2d918643bd79aa73f1d1581126a59b115023b798abea591e7f810b21e3c9ba9729c1564ae1598b5b3e52b64ee35afe4a490213f0234111093cf68cf5d292f490d07376652ce39366f1e7aa786f40bc3c2d918643bd79aa73f1d1581126a59b115023b798abea591e7f810b21e3c9ba9729c1564ae1598b5b3e52b64ee35afe4a490213f0234111093cf68cf5d292f490d07376652ce39366f1e7aa786f40bc3c2d918643bd79aa73f1d1581126a59b115023b798abea591e7f810b21e3c9ba9729c1564ae1598b5b3e52b64ee35afe4a490213f0234111093cf68cf5d292f4030ced986a5d728cacf2b449c00d06ea”; cipher text length = 2016;
* expected output: plain text = "01234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789”; plain text length = 2000;
* expected return: 1 (operation succeeds)

### 2.2.5 TC_dllSymmetryDecrypt_aes_128_ecb_in_cipherlen_wrong
**Purpose:** To check the function behaviors when various cipherlen values are input<br>
**Test setup:** cipher name = “aes-128-ecb”; key = “akey”; iv = “”; cipher text = “c1a9d48932d01b10913b29e6e43f3126”;  <br>
**Sub test cases 1: Input cipher text length is correct**
* input:  cipher text length = 16;
* expected output: plain text = "Hello World!”; plain text length = 12;
* expected return: 1 (operation succeeds)

**Sub test cases 2: Input cipher text length is shorter**
* input:  cipher text length = 16 - 1;
* expected output: /
* expected return: != 1 (operation does not succeed)

**Sub test cases 3: Input cipher text length is longer**
* input:  cipher text length = 16 + 1;
* expected output: /
* expected return: != 1 (operation does not succeed)

**Sub test cases 4: Input cipher text length = 0**
* input:  cipher text length = 0;
* expected output: /
* expected return: != 1 (operation does not succeed)



